# Specification [WIP]

This specification is a work in progress as features are added to the language. For now, assume that all Markdown is valid and any extensions that are not part of the [CommonMark specification](https://spec.commonmark.org/0.31.2/) will be detailed below. Until 1.0, there are no guarantees that all CommonMark will be valid. However, unless you're doing something uncommon (pun not intented) it will likely work.

## Frontmatter

Frontmatter is a 1-1 mapping with [Obsidian properties](https://help.obsidian.md/Editing+and+formatting/Properties). Certain fields in frontmatter con be configured to allow Notedown to infer structure, for example `type: project`, these are optional.

## Types

TODO: think through how note types could be defined/extended. Do built-in types make sense (e.g. projects)?

## Tasks

Tasks can be created in any note using the following format:

```
- [ ] Write the Notedown specification
```

### Status

Status is indicated by the value enclosed between the square brackets.

```md
- [ ] todo
- [b] blocked
- [/] doing
- [x] done
- [a] abandoned
```

### Fields

Fields can be chained to the end of tasks via space separation. Order does not matter, fields cannot be declared multiple times on the same tasks. 

```
- [ ] Write the nl specification priority:1 scheduled: 2024-01-01
```

#### Due Dates

Due dates are indicated by the `due:` key. The value is a date in the format `YYYY-MM-DD`.

```md
- [ ] some task due:2024-01-01
- [ ] some task d:2024-01-01
```

#### Scheduled dates

Scheduled dates are indicated by the `scheduled:` key. The value is a date in the format `YYYY-MM-DD`. Scheduled dates differ from due dates in that they are not a hard deadline but rather a date that the task is scheduled to be worked on.

```md
- [ ] some task scheduled:2024-01-01
- [ ] some task s:2024-01-01
```

#### Priority

Priority is indicated by the `priority:` key. The value is an integer between 0 and 10.

```md
- [ ] some task priority:1
- [ ] some task p:1
```

#### Recurrences (every)

Recurrences are indicated by the `every:` field. Recurrences are triggered on task completion and will create a new task directly above it in the note with the same configuration but with the due date incremented by the specified interval relative to the time of completion.

```md
- [ ] some task every:day
- [ ] some task e:day
- [ ] some task every:2 weeks
- [ ] some task every:15th, 30th
- [ ] some task every:1st jan
- [ ] some task every:jan june
```
A more complete list of recurrence formats can be found in the [tasks test cases](./pkg/parsers/task_test.go).

#### Completed

Completed tasks are indicated by the `completed:` key. The value is a date in the format `YYYY-MM-DD`. These values are automatically generated by the TUI or LSP upon task completion, but can be manually set.

```md
- [ ] some task completed:2024-01-01
```
